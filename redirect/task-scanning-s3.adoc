---
permalink: task-scanning-s3.html
redirect: data-services-data-classification/task-scanning-overview.html
---

// ---
// sidebar: sidebar
// permalink: task-scanning-s3.html
// keywords: cloud compliance, amazon s3, s3 buckets, amazon s3 buckets, scan s3 buckets, data sense, 
// summary: NetApp Data Classification can scan your Amazon S3 buckets to identify the personal and sensitive data that resides in S3 object storage. Data Classification can scan any bucket in the account, regardless if it was created for a NetApp solution.
// ---

// = Scan Amazon S3 buckets with NetApp Data Classification
// :hardbreaks:
// :nofooter:
// :icons: font
// :linkattrs:
// :imagesdir: ./media/

// [.lead]
// NetApp Data Classification can scan your Amazon S3 buckets to identify the personal and sensitive data that resides in S3 object storage. Data Classification can scan any bucket in the account, regardless if it was created for a NetApp solution.

// ====
// *NOTE*    This information is relevant only for Data Classification legacy versions 1.30 and earlier.
// ====

// == Quick start

// Get started quickly by following these steps, or scroll down to the remaining sections for full details.

// .image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-1.png[One] Set up the S3 requirements in your cloud environment

// [role="quick-margin-para"]
// Ensure that your cloud environment can meet the requirements for Data Classification, including preparing an IAM role and setting up connectivity from Data Classification to S3. <<Reviewing S3 prerequisites,See the complete list>>.

// .image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-2.png[Two] Deploy the Data Classification instance

// [role="quick-margin-para"]
// link:task-deploy-cloud-compliance.html[Deploy Data Classification^] if there isn't already an instance deployed.

// .image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-3.png[Three] Activate Data Classification on your S3 system

// [role="quick-margin-para"]
// Select the Amazon S3 system, select *Enable*, and select an IAM role that includes the required permissions.

// .image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-4.png[Four] Select the buckets to scan

// [role="quick-margin-para"]
// Select the buckets that you'd like to scan and Data Classification will start scanning them.

// == Reviewing S3 prerequisites

// The following requirements are specific to scanning S3 buckets.

// [[policy-requirements]]

// Set up an IAM role for the Data Classification instance::
// Data Classification needs permissions to connect to the S3 buckets in your account and to scan them. Set up an IAM role that includes the permissions listed below. You'll receive a prompt to select an IAM role when you enable Data Classification on the Amazon S3 system.
// +
// [source,json]
// {
//   "Version": "2012-10-17",
//   "Statement": [
//       {
//           "Effect": "Allow",
//           "Action": [
//               "s3:Get*",
//               "s3:List*",
//               "s3:PutObject"
//           ],
//           "Resource": "*"
//       },
//       {
//           "Effect": "Allow",
//           "Action": [
//               "iam:GetPolicyVersion",
//               "iam:GetPolicy",
//               "iam:ListAttachedRolePolicies"
//           ],
//           "Resource": [
//               "arn:aws:iam::*:policy/*",
//               "arn:aws:iam::*:role/*"
//           ]
//       }
//   ]
// }

// Provide connectivity from Data Classification to Amazon S3::
// Data Classification needs a connection to Amazon S3. The best way to provide that connection is through a VPC Endpoint to the S3 service. For instructions, see https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpce-gateway.html#create-gateway-endpoint[AWS Documentation: Creating a Gateway Endpoint^].
// +
// When you create the VPC Endpoint, be sure to select the region, VPC, and route table that corresponds to the Data Classification instance. You must also modify the security group to add an outbound HTTPS rule that enables traffic to the S3 endpoint. Otherwise, Data Classification can't connect to the S3 service.
// +
// If you experience any issues, see https://aws.amazon.com/premiumsupport/knowledge-center/connect-s3-vpc-endpoint/[AWS Support Knowledge Center: Why can't I connect to an S3 bucket using a gateway VPC endpoint?^]
// +
// An alternative is to provide the connection by using a NAT Gateway.
// +
// NOTE: You can't use a proxy to get to S3 over the internet.

// == Deploying the Data Classification instance

// link:task-deploy-cloud-compliance.html[Deploy Data Classification in the NetApp Console^] if there isn't already an instance deployed.

// You need to deploy the instance using a Console agent deployed in AWS so that Console automatically discovers the S3 buckets in this AWS account and displays them in an Amazon S3 system.

// *Note:* Deploying Data Classification in an on-premises location is not currently supported when scanning S3 buckets.

// Upgrades to Data Classification software are automated as long as the instance has internet connectivity.

// == Activating Data Classification on your S3 system

// Enable Data Classification on Amazon S3 after you verify the prerequisites.

// .Steps

// . From the Console, select *Storage > Systems page*.

// . Select the Amazon S3 system.
// +
// image:screenshot_s3_we.gif[A screenshot of an Amazon S3 system icon]

// . In the Services pane on the right, select *Enable* next to *Classification*.
// +
// image:screenshot_s3_enable_compliance.png[A screenshot of enabling the Data Classification service from the Services panel]

// . When prompted, assign an IAM role to the Data Classification instance that has <<Reviewing S3 prerequisites,the required permissions>>.
// +
// image:screenshot_s3_compliance_iam_role.png[A screenshot of entering the AWS IAM role for Data Classification]

// . Select *Enable*.

// TIP: You can also enable compliance scans for a system from the Configuration page by selecting the image:button-gallery-options.gif[three dots] button then *Activate Data Classification*.

// .Result

// The Console assigns the IAM role to the instance.

// == Enabling and disabling compliance scans on S3 buckets

// After Data Classification is enabled Amazon S3, you need to configure the buckets that you want to scan.

// When Data Classification is running in the AWS account that has the S3 buckets you want to scan, it discovers those buckets and displays them in an Amazon S3 system.

// Data Classification can also <<Scanning buckets from additional AWS accounts,scan S3 buckets that are in different AWS accounts>>.

// .Steps

// . Select the Amazon S3 system.

// . In the Services pane on the right, select *Configure Buckets*.
// +
// image:screenshot_s3_configure_buckets.png[A screenshot of clicking Configure Buckets to choose the S3 buckets you want to scan]

// . Enable mapping-only scans, or mapping and classification scans, on your buckets.
// +
// image:screenshot_s3_select_buckets.png[A screenshot of selecting the S3 buckets you want to scan]
// +
// [cols="45,45",width=90%,options="header"]
// |===
// | To:
// | Do this:

// | Enable mapping-only scans on a bucket | Select *Map*
// | Enable full scans on a bucket | Select *Map & Classify*
// | Disable scanning on a bucket | Select *Off*

// |===

// .Result

// Data Classification starts scanning the S3 buckets that you enabled. If there are any errors, they'll appear in the Status column, alongside the required action to fix the error.

// == Scanning buckets from additional AWS accounts

// You can scan S3 buckets that are under a different AWS account by assigning a role from that account to access the existing Data Classification instance.

// .Steps

// . Go to the target AWS account where you want to scan S3 buckets and create an IAM role by selecting *Another AWS account*.
// +
// image:screenshot_iam_create_role.gif[A screenshot of the AWS page to create an IAM role.]
// +
// Be sure to do the following:

// * Enter the ID of the account where the Data Classification instance resides.
// * Change the *Maximum CLI/API session duration* from 1 hour to 12 hours and save that change.
// * Attach the Data Classification IAM policy. Make sure it has the required permissions.
// +
// [source,json]
// {
//   "Version": "2012-10-17",
//   "Statement": [
//       {
//           "Effect": "Allow",
//           "Action": [
//               "s3:Get*",
//               "s3:List*",
//               "s3:PutObject"
//           ],
//           "Resource": "*"
//       },
//   ]
// }

// . Go to the source AWS account where the Data Classification instance resides and select the IAM role that is attached to the instance.
// .. Change the *Maximum CLI/API session duration* from 1 hour to 12 hours. Save the change.
// .. Select *Attach policies* then *Create policy*.
// .. Create a policy that includes the "sts:AssumeRole" action and specify the ARN of the role that you created in the target account.
// +
// [source,json]
// {
//     "Version": "2012-10-17",
//     "Statement": [
//         {
//             "Effect": "Allow",
//             "Action": "sts:AssumeRole",
//             "Resource": "arn:aws:iam::<ADDITIONAL-ACCOUNT-ID>:role/<ADDITIONAL_ROLE_NAME>"
//         },
//         {
//             "Effect": "Allow",
//             "Action": [
//                 "iam:GetPolicyVersion",
//                 "iam:GetPolicy",
//                 "iam:ListAttachedRolePolicies"
//             ],
//             "Resource": [
//                 "arn:aws:iam::*:policy/*",
//                 "arn:aws:iam::*:role/*"
//             ]
//         }
//     ]
// }
// +
// The Data Classification instance profile account receives access to the additional AWS account.

// . Navigate to the *Amazon S3 Configuration* page and the new AWS account is displayed. Note that it can take a few minutes for Data Classification to sync the new account's system and show this information.
// +
// image:screenshot_activate_and_select_buckets.png[A screenshot showing how to activate Data Classification.]

// . Select *Activate Data Classification & Select Buckets* and select the buckets you want to scan.

// .Result

// Data Classification starts scanning the new S3 buckets that you enabled.
